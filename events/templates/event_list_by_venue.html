{% extends 'main.html' %}

{% load events_extras %}


{% block content %}

    {% include 'hero.html' %}

    <section class="event-list">
        <nav>
            <a class="sort-option" href="{% url 'the_list' sorting='by-date' %}">By Date</a>
            <span class="sort-option active">By Venue</span>
        </nav>

        {% for venue, events in grouped_events %}
            <div class="event-group">
                <h3>{{ venue }}</h3>
                <ul class="by-venue">
                    {% for event in events %} 
                        
                        {% if event.url %}
                            <li>
                                <a href="{{ event.url }}" target="_blank">{{ event }}</a> - 

                                {% if "12am" in event.start_time|date:"fa"|remove_periods and event.admission_price %}
                                    {{ event.start_date | date:"l, F j" }},
                                {% else %}
                                    {{ event.start_date | date:"l, F j" }}
                                {% endif %}

                                {% if event.start_time and event.end_time %}
                                    {% if event.admission_price or event.extra_info %}
                                        from {{ event.start_time | date:"fa" | remove_periods }}-{{ event.end_time | date:"fa" | remove_periods }},
                                    {% else %}
                                        from {{ event.start_time | date:"fa" | remove_periods }}-{{ event.end_time | date:"fa" | remove_periods }}
                                    {% endif %}
                                {% elif "12am" not in event.start_time|date:"fa"|remove_periods %}
                                    {% if event.admission_price or event.extra_info %}
                                        at {{ event.start_time | date:"fa" | remove_periods }},
                                    {% else %}
                                        at {{ event.start_time | date:"fa" | remove_periods }}
                                    {% endif %}
                                {% endif %}

                                {% if event.admission_price and event.extra_info %}
                                    {{ event.admission_price }}, {{ event.extra_info }}
                                {% elif event.admission_price %}
                                    {{ event.admission_price }}
                                {% elif event.extra_info %}
                                    {{ event.extra_info }}
                                {% endif %}
                            </li>

                        {% else %}
                            <li>
                                {{ event }} -

                                {% if "12am" in event.start_time|date:"fa"|remove_periods and event.admission_price %}
                                    {{ event.start_date | date:"l, F j" }},
                                {% else %}
                                    {{ event.start_date | date:"l, F j" }}
                                {% endif %}
                                    
                                {% if event.start_time and event.end_time %}
                                    {% if event.admission_price or event.extra_info %}
                                        from {{ event.start_time | date:"fa" | remove_periods }}-{{ event.end_time | date:"fa" | remove_periods }},
                                    {% else %}
                                        from {{ event.start_time | date:"fa" | remove_periods }}-{{ event.end_time | date:"fa" | remove_periods }}
                                    {% endif %}
                                {% elif "12am" not in event.start_time|date:"fa"|remove_periods %}
                                    {% if event.admission_price or event.extra_info %}
                                        at {{ event.start_time | date:"fa" | remove_periods }},
                                    {% else %}
                                        at {{ event.start_time | date:"fa" | remove_periods }}
                                    {% endif %}
                                {% endif %}

                                {% if event.admission_price and event.extra_info %}
                                    {{ event.admission_price }}, {{ event.extra_info }}
                                {% elif event.admission_price %}
                                    {{ event.admission_price }}
                                {% elif event.extra_info %}
                                    {{ event.extra_info }}
                                {% endif %}
                        {% endif %} 
                    
                    {% endfor %}
                </ul>
            </div>
        {% endfor %}
    </section>

{% endblock content %}
